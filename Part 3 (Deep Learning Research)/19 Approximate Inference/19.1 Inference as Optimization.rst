19.1 Inference as Optimization
=================================

Exact inference can be described as an optimization problem. 

* Goal: compute :math:`\log p(v; \theta)`
* Challenge: costly to marginalize out h
* Solution: Compute the lower bound of :math:`\log p(v; \theta)`, aka evidence lower bound (ELBO).

Introduce q as an arbitrary distribution over h



.. math::

	\begin {equation}
	\begin{split}
	KL[q(h) || p(h|x)] &= \sum_h q(h) \log \frac{q(h)}{p(h|x)} \\
	&= \sum_h q(h) \log \frac{q(h)}{\frac {p(x, h)}{p(x)}} \\
	&= \sum_h q(h) \log p(x) + \sum_h q(h) \log q(h) - \sum_h q(h) \log p(x, h) \\
	&= \log p(x) - H(q) - E_{h\sim q}[\log p(x, h)]  
	\end{split}
	\end {equation}

Now we have 

.. math::
	
	\log p(x) = E_{h\sim q}[\log p(x, h)] + KL[q(h) || p(h|x)] + H(q)

Because KL divergence is always nonnegative we have lower bound 

.. math::
	L(v, \theta, h) = E_{h\sim q}[\log p(x, h)] + H(q)

For appropriate of q, L is tractable to compute. For q(h) **(textbook: q(h|v))** that are better approaximation of p(h|v), the lower bound would be tighter, meaning closer to log p(v). When q(h) = p(v|h), the approaximation is perfect, :math:`L(v, \theta, q) = log P(x; \theta)`.

We can think of inference as the procedure for finding the q that maximizes L. Solutions

* Exact inference maximizes L perfectly by searching over a family of functions q that includes p(h|x). (Brute Force)
* Approximate by restricting the family of distribution q that the optimization is allowed to search over
* Approxiamte by using imperfect optimization procedure that may not completely maximize L but may only increase it by significant amount.


Review on Shannon entropy

We can quantify the amount of uncertainty in an entire probability distribution using the Shannon entropy:

.. math::
	H(x) = E_{x \sim P}(I(x)) = - E_{x \sim P}(\log P(x))



####################################
Resource
####################################

* `Understanding the Variational Lower Bound <http://users.umiacs.umd.edu/~xyang35/files/understanding-variational-lower.pdf>`_
* `Variational Autoencoder <https://www.youtube.com/watch?v=uaaqyVS9-rM>`_